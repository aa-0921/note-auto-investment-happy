// autoCreateAndDraftNote.js
// 薄いラッパー：既存のCLI引数・動作は維持しつつ、実装は共有ライブラリに委譲

import { runWithCore } from '@aa-0921/note-auto-core';

(async () => {
  await runWithCore(async ({ core, wantsBackground }) => {
    // アカウント固有の題材・切り口（ここで管理）
    const topics = [
      '資産運用の基礎',
      '投資初心者向けガイド',
      // 投資信託について多めに
      '投資信託',
      '投資信託のメリット',
      '株式投資の始め方',
      'FIRE（経済的自立・早期退職）',
      'FIRE達成のための戦略',
      '資産形成の基本',
      '投資初心者の悩み',
      '長期投資のメリット',
      '投資家のマインドセット',
      '資産運用の最初のステップ',
      '効率的な投資ポートフォリオ',
      '投資で失敗しないための心構え',
      '初心者からの資産形成',
      '成功投資家の1日・投資スタイル',
      '自身の投資における成功談・失敗談',
    ];

    const patterns = [
      '一歩踏み込んだ理解',
      '具体的な活用方法',
      '楽にする方法',
      '投資することのメリット',
      '複利効果の威力',
      // ランキングを多めに
      'ランキング-トップ5',
      'ランキング-トップ5',
      'ランキング-トップ5',
      'ランキング-トップ5',
      'まつわるQ&Aまとめ',
      'やってはいけないNG行動',
      '初心者が最初の1ヶ月でやることリスト',
      'プロに聞いた極意',
      '続けるためのモチベーション維持法',
      'ありがちな勘違いと正しいやり方',
      '成功例・失敗例から学ぶ',
      '「何から始めるべきか」という初心者の疑問に答える',
      '具体的な投資フェーズと目標設定',
      'モチベーション維持のコツや、投資を継続するためのマインドセット',
      'つみたてNISAとiDeCoの基本的な使い方を実践的に解説',
      '各投資商品の「なぜ選ぶのか」という目的を明確にする',
      '初心者でもすぐに使える実践的な投資手法',
      '自身の具体的な投資経験談を交え、読者に共感と学びを提供する',
      '資産形成の具体的なステップや目標達成方法',
      '投資の面白さや大変さを伝える',
      'ポートフォリオ管理の重要性と具体的な方法',
      '投資コミュニティでの円滑なコミュニケーション術',
      'リスク管理を成長の機会に変えるマインドセット'
    ];

    const rewriteConditionsLines = [
      'あなたはプロの投資家で、プロの編集者です。',
      '指定の見出し本文が短いため、200文字以上になるよう実体験や具体例、学習アドバイス、キャリアのヒントを交えて厚くリライト・追記してください。',
      '【注意】',
      '- タイトルや見出しは出力せず、本文のみを返す。',
      '- メタ情報（追加要素や文字数など）は一切出力しない。',
      '- 丁寧な敬語（です・ます）で、読みやすさ重視。',
      '- 絵文字を多めに、各行に1つ程度。',
      '- 元の内容に沿い、noteのMarkdownのみ使用。',
      '- 箇条書きは「・ 」、番号付きリストは使わない。',
    ];

    // LLM用システムプロンプト（参考実装に準拠）
    const systemMessage = 'あなたは日本語のnote記事編集者です。';

    // 記事生成プロンプト条件（参考実装の「promptLines」相当）
    const articleConditionsLines = [
      'タイトル、本文、ハッシュタグ（#から始まるもの）を含めてください。',
      'タイトルは1行目に「# [実際のタイトル]」として記載してください。',
      '「# タイトル」という文字列ではなく、実際の記事タイトルを入れてください。',
      '本文は見出しや箇条書きも交えて1000文字程度で丁寧にまとめてください。',
      'ハッシュタグは記事末尾に「#〇〇 #〇〇 ...」の形式でまとめてください。',
      'すべて日本語で出力してください。',
      '切り口に沿った内容になるようにしてください。',
      'あなたはプロの投資家で、プロの編集者です。',
      '読みやすさを重視してください',
      'もし題材・切り口を鑑みて可能であればランキング形式にしてください',
      '改行を多めに入れて、読みやすくしてください。',
      '文章作成時に多めに、たくさん絵文字を使用してください。各行に1つくらいは入れてください。',
      'この記事を読んだ人が投資したい、とモチベーションが上がるような内容にしてください。',
      '投資初心者がつい読みたくなるような、やさしく親しみやすい内容にしてください。',
      '現役の投資家向けの難しい内容や専門的すぎる話題は避けてください。',
      '記事内で「こんにちは！○○と申します」のような自己紹介や名前を名乗ることは避けてください。',
      'noteの正しいマークダウン記法のみを使ってください。',
      '箇条書きはマークダウンではなく、「・ 」で表現してください。',
      '見出しはh2（## 見出し）・h3（### 見出し）のみ。',
      '番号付きリストは使わないようにしてください。',
      'h1（# タイトル）はタイトル行のみで本文中では使わないでください。',
      'その他のマークダウンやHTMLタグは使わないでください。',
    ];

    // タグ生成の指示文（参考実装：固定タグの必須含有を要求）
    const tagsInstruction =
      '記事内容から最も関連する日本語タグを3〜5個生成し、半角スペース区切りで出力してください。必ず「#資産運用 #投資 #運用 #株 #投資信託 #FIRE」を含めてください。本文や説明は禁止。';

    // タイトル装飾用絵文字（参考実装のセット）
    const titleEmojis = [
      '❤️',
      '🌸',
      '🛑',
      '㊙︎',
      '🟥',
      '🈲',
      '🉐',
      '㊗️',
      '㊙️',
      '⭕',
      '‼️',
      '🎉',
    ];

    // 記事内に挿入するアフィリエイト文（参考実装の体裁を反映）
    const affiliateLink = [
      '',
      '💰　💎　💰　💎　💰　💎　💰　💎　💰　💎　💰　💎　💰　💎　💰',
      'https://amzn.to/41MwWSl',
      '👆お金のことを広く学ぶのに最適です！コスパ最高です😊',
      '💰　💎　💰　💎　💰　💎　💰　💎　💰　💎　💰　💎　💰　💎　💰',
      '',
    ].join('\n');

    // マガジン誘導文（参考実装の体裁を反映）
    const magazinePromotion = [
      '🐈　🐾　🐈‍⬛　🐾　🐈　🐾　🐈‍⬛　🐾　🐈　🐾　🐈‍⬛　🐾　🐈　🐾　🐈‍⬛　',
      '',
      '✅「そろそろ資産運用、何か始めたい！」というあなたへ',
      '',
      '投資に興味はあるけど、「何から始めればいい？」「失敗が怖い…」そんな不安を、無料で解消できるマガジンを用意しました。',
      '',
      '【早めに不安を払拭する資産運用】',
      '✔ まずは小さく始めたい',
      '✔ 仕組みをシンプルに知りたい',
      'そんな人にピッタリです。',
      '',
      '安心して一歩踏み出すヒントを、無料でどうぞ。',
      '',
      'https://note.com/investment_happy/m/m76229c09696b',
      '',
      '🐈　🐾　🐈‍⬛　🐾　🐈　🐾　🐈‍⬛　🐾　🐈　🐾　🐈‍⬛　🐾　🐈　🐾　🐈‍⬛　',
      '',
    ].join('\n');

    // アソシエイト表記文（参考実装の文言）
    const amazonAssociateText =
      'Amazon のアソシエイトとして、「まずは100円から💹投資|運用|資産形成」は適格販売により収入を得ています。';

    // 記事の自動生成と下書き保存機能を実行
    await core.runAutoCreateAndDraftNote({
      background: wantsBackground,
      topics,
      patterns,
      systemMessage,
      articleConditionsLines,
      rewriteConditionsLines,
      tagsInstruction,
      titleEmojis,
      affiliateLink,
      magazinePromotion,
      amazonAssociateText,
    });
    console.log('記事の自動生成と下書き保存が完了しました');
  });
})();
